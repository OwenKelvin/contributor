<div class="space-y-6">
  <!-- Search and Filters -->
  <div hlmCard>
    <div hlmCardHeader>
      <h3 hlmCardTitle>User Activity Log</h3>
      <p hlmCardDescription>Track and monitor user actions across the platform</p>
    </div>
    <div hlmCardContent>
      <div class="flex gap-4">
        <div class="flex-1">
          <label hlmLabel for="search">Search</label>
          <div class="relative">
            <ng-icon
              name="lucideSearch"
              class="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"
              size="sm"
            />
            <input
              hlmInput
              id="search"
              type="text"
              placeholder="Search by user, action, or description..."
              class="pl-10"
              [value]="searchTerm()"
              (input)="onSearchChange($any($event.target).value)"
            />
          </div>
        </div>
        <div class="w-64">
          <label hlmLabel for="action-filter">Filter by Action</label>
          <select
            hlmInput
            id="action-filter"
            (change)="onActionFilterChange($event)"
            [value]="selectedAction()"
          >
            <option value="">All Actions</option>
            <option value="LOGIN">Login</option>
            <option value="LOGOUT">Logout</option>
            <option value="PROJECT_CREATED">Project Created</option>
            <option value="PROJECT_UPDATED">Project Updated</option>
            <option value="PROJECT_DELETED">Project Deleted</option>
            <option value="PROFILE_UPDATED">Profile Updated</option>
            <option value="CONTRIBUTION_MADE">Contribution Made</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Activity Timeline -->
  <div hlmCard>
    <div hlmCardHeader>
      <h3 hlmCardTitle>Recent Activity</h3>
      <p hlmCardDescription>
        Showing {{ filteredActivities().length }} activities
      </p>
    </div>
    <div hlmCardContent>
      @if (isLoading()) {
        <div class="flex items-center justify-center py-12">
          <div class="text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
            <p class="mt-4 text-sm text-muted-foreground">Loading activities...</p>
          </div>
        </div>
      } @else if (filteredActivities().length === 0) {
        <div class="text-center py-12">
          <ng-icon name="lucideHistory" size="xl" class="text-muted-foreground mx-auto mb-4" />
          <h3 class="text-lg font-semibold mb-2">No activities found</h3>
          <p class="text-sm text-muted-foreground">
            @if (searchTerm() || selectedAction()) {
              Try adjusting your filters
            } @else {
              No user activities recorded yet
            }
          </p>
        </div>
      } @else {
        <div class="space-y-4">
          @for (activity of filteredActivities(); track activity.id) {
            <div class="flex gap-4 p-4 border rounded-lg hover:bg-slate-50 transition-colors">
              <!-- Timeline dot -->
              <div class="flex flex-col items-center">
                <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0">
                  <ng-icon name="lucideActivity" class="text-blue-600" size="sm" />
                </div>
                @if (!$last) {
                  <div class="w-0.5 h-full bg-slate-200 mt-2"></div>
                }
              </div>

              <!-- Activity content -->
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between gap-4 mb-2">
                  <div class="flex-1">
                    <div class="flex items-center gap-2 mb-1">
                      <span class="font-medium">{{ activity.userName }}</span>
                      <span [class]="'inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ' + getActionBadgeClass(activity.action)">
                        {{ activity.action.replace('_', ' ') }}
                      </span>
                    </div>
                    <p class="text-sm text-muted-foreground">{{ activity.userEmail }}</p>
                  </div>
                  <div class="text-right flex-shrink-0">
                    <div class="text-sm text-muted-foreground flex items-center gap-1">
                      <ng-icon name="lucideCalendar" size="sm" />
                      {{ formatTimestamp(activity.timestamp) }}
                    </div>
                    @if (activity.ipAddress) {
                      <div class="text-xs text-muted-foreground mt-1">
                        IP: {{ activity.ipAddress }}
                      </div>
                    }
                  </div>
                </div>
                <p class="text-sm">{{ activity.description }}</p>
              </div>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
