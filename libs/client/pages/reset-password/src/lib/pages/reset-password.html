<div class="flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900">
  <div class="w-full max-w-md">
    <hlm-card>
      <hlm-card-header>
        <hlm-card-title>Reset Password</hlm-card-title>
        <hlm-card-description>
          Enter your new password below.
        </hlm-card-description>
      </hlm-card-header>
      <hlm-card-content>
        @if (token()) {
          <form (ngSubmit)="onSubmit($event)" class="space-y-4">
            <div class="space-y-2">
              <hlm-label for="newPassword">New Password</hlm-label>
              <div class="relative">
                <hlm-icon name="lucideLock" class="absolute left-3 top-1/2 -translate-y-1/2" />
                <input hlmInput type="password" id="newPassword" placeholder="••••••••" [formField]="resetPasswordForm.newPassword" class="pl-10" />
              </div>
              @if (resetPasswordForm.newPassword.state() === 'INVALID_TOUCHED' || resetPasswordForm.newPassword.state() === 'INVALID_DIRTY') {
                <p class="text-red-500 text-sm mt-1">{{ resetPasswordForm.newPassword.errors()[0]?.message }}</p>
              }
            </div>

            <div class="space-y-2">
              <hlm-label for="confirmPassword">Confirm Password</hlm-label>
              <div class="relative">
                <hlm-icon name="lucideKey" class="absolute left-3 top-1/2 -translate-y-1/2" />
                <input hlmInput type="password" id="confirmPassword" placeholder="••••••••" [formField]="resetPasswordForm.confirmPassword" class="pl-10" />
              </div>
              @if (resetPasswordForm.confirmPassword.state() === 'INVALID_TOUCHED' || resetPasswordForm.confirmPassword.state() === 'INVALID_DIRTY') {
                <p class="text-red-500 text-sm mt-1">{{ resetPasswordForm.confirmPassword.errors()[0]?.message }}</p>
              }
            </div>

            @if (successMessage()) {
              <div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4" role="alert">
                <p>{{ successMessage() }}</p>
              </div>
            }
            @if (errorMessage()) {
              <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4" role="alert">
                <p>{{ errorMessage() }}</p>
              </div>
            }

            <button hlmBtn [disabled]="isLoading()" type="submit" class="w-full">
              @if (isLoading()) {
                <hlm-icon name="lucideLoader2" class="animate-spin mr-2" />
              }
              Reset Password
            </button>
          </form>
        } @else {
          <div class="text-center text-red-500">
            <p>Invalid or missing password reset token.</p>
            <a routerLink="/forgot-password" hlmBtn variant="link">Request a new link</a>
          </div>
        }
      </hlm-card-content>
      <hlm-card-footer class="flex justify-center">
        <a routerLink="/login" hlmBtn variant="link">Back to Login</a>
      </hlm-card-footer>
    </hlm-card>
  </div>
</div>
