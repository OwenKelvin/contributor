<div class="container mx-auto p-6 max-w-4xl">
  <!-- Header -->
  <div class="mb-6">
    <div class="flex items-center justify-between mb-2">
      <h1 class="text-3xl font-bold tracking-tight">My Activity</h1>
      <button hlmBtn variant="outline" size="sm" (click)="refresh()" [disabled]="isLoading()">
        <ng-icon hlmIcon name="lucideRefreshCw" size="sm" [class.animate-spin]="isLoading()" />
        Refresh
      </button>
    </div>
    <p class="text-muted-foreground">
      Track your actions and contributions on the platform
    </p>
  </div>

  <!-- Activity Timeline Card -->
  <div hlmCard>
    <div hlmCardHeader>
      <h3 hlmCardTitle class="flex items-center gap-2">
        <ng-icon hlmIcon name="lucideHistory" size="sm" />
        Your Activity Timeline
      </h3>
      <p hlmCardDescription>
        @if (totalCount() > 0) {
          Showing {{ activities().length }} of {{ totalCount() }} activities
        } @else {
          No activities yet
        }
      </p>
    </div>
    <div hlmCardContent>
      @if (isLoading()) {
        <!-- Loading State -->
        <div class="flex items-center justify-center py-16">
          <div class="text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"></div>
            <p class="mt-4 text-sm text-muted-foreground">Loading your activities...</p>
          </div>
        </div>
      } @else if (activities().length === 0) {
        <!-- Empty State -->
        <div class="text-center py-16">
          <ng-icon hlmIcon name="lucideHistory" size="xl" class="text-muted-foreground mx-auto mb-4" />
          <h3 class="text-lg font-semibold mb-2">No activity yet</h3>
          <p class="text-sm text-muted-foreground mb-4">
            Your actions on the platform will appear here
          </p>
          <p class="text-xs text-muted-foreground">
            Try making a contribution or updating your profile to see your activity
          </p>
        </div>
      } @else {
        <!-- Activity Timeline -->
        <div class="space-y-0">
          @for (activity of activities(); track activity.id; let isLast = $last) {
            <div class="flex gap-4 p-4 border-b last:border-b-0 hover:bg-muted/30 transition-colors rounded-lg">
              <!-- Timeline Icon -->
              <div class="flex flex-col items-center">
                <div 
                  [class]="'w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ' + getActionColor(activity.action)"
                >
                  <ng-icon 
                    hlmIcon 
                    [name]="getActionIcon(activity.action)" 
                    size="sm" 
                  />
                </div>
                @if (!isLast) {
                  <div class="w-0.5 flex-1 bg-border mt-2 min-h-[20px]"></div>
                }
              </div>

              <!-- Activity Content -->
              <div class="flex-1 min-w-0 pt-1">
                <div class="flex items-start justify-between gap-4 mb-1">
                  <p class="text-sm font-medium">{{ getActivityDescription(activity) }}</p>
                  <div 
                    class="text-xs text-muted-foreground flex items-center gap-1 flex-shrink-0 cursor-help" 
                    [title]="formatFullTimestamp(activity.createdAt)"
                  >
                    <ng-icon hlmIcon name="lucideCalendar" size="xs" />
                    {{ formatTimestamp(activity.createdAt) }}
                  </div>
                </div>
                
                <!-- Action Type Badge -->
                <div class="flex items-center gap-2 mt-2">
                  <span class="inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-muted text-muted-foreground">
                    {{ getActionLabel(activity.action) }}
                  </span>
                  @if (activity.targetType) {
                    <span class="inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-muted/50 text-muted-foreground">
                      {{ activity.targetType }}
                    </span>
                  }
                </div>
              </div>
            </div>
          }
        </div>

        <!-- Pagination -->
        @if (totalCount() > pageSize) {
          <div class="flex items-center justify-between pt-4 mt-4 border-t">
            <div class="text-sm text-muted-foreground">
              Showing {{ activities().length }} of {{ totalCount() }} activities
            </div>
            
            <div class="flex items-center gap-2">
              <button
                hlmBtn
                variant="outline"
                size="sm"
                (click)="previousPage()"
                [disabled]="!hasPreviousPage() || isLoading()"
              >
                <ng-icon hlmIcon name="lucideChevronLeft" size="sm" />
                Previous
              </button>
              
              <button
                hlmBtn
                variant="outline"
                size="sm"
                (click)="nextPage()"
                [disabled]="!hasNextPage() || isLoading()"
              >
                Next
                <ng-icon hlmIcon name="lucideChevronRight" size="sm" />
              </button>
            </div>
          </div>
        }
      }
    </div>
  </div>

  <!-- Info Card -->
  <div hlmCard class="mt-6">
    <div hlmCardContent class="pt-6">
      <div class="flex items-start gap-3">
        <ng-icon hlmIcon name="lucideFileText" class="text-muted-foreground mt-0.5" />
        <div class="text-sm text-muted-foreground">
          <p class="font-medium text-foreground mb-1">About Your Activity</p>
          <p>
            This timeline shows your recent actions on the platform, including logins, 
            profile updates, project creations, and contributions. Your activity history 
            helps you track your engagement and contributions over time.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
