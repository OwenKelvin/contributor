<div class="p-6 space-y-6 max-w-2xl">
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-3xl font-bold tracking-tight">New contribution</h1>
      <p class="text-muted-foreground">
        Add a new contribution to your project
      </p>
    </div>
  </div>

  <!-- Form now uses [formField] directive for two-way binding -->
  <form (submit)="onSubmit($event)" class="space-y-6">

    <!-- Project Field -->
    <div class="space-y-2">
      <label hlmLabel for="project">Project *</label>
      <hlm-select id="project" scrollable="true" placeholder="Select a project" [field]="contributionForm.project">
        <hlm-select-trigger class="w-full">
          <hlm-select-value>
            <div class="flex items-center gap-x-2" *brnSelectValue="let value">
              {{ value.title }}({{ value.startDate | date: 'mediumDate' }} - {{ value.endDate | date: 'mediumDate' }})
            </div>
          </hlm-select-value>
        </hlm-select-trigger>
        <hlm-select-content class="max-h-96 min-w-[325px]">
          <hlm-select-scroll-up />
          @for (project of projects(); track project.id) {
            <hlm-option [value]="$any(project)">
              <div>
                <div class="font-semibold">{{ project.title }}</div>
                <p class="text-sm text-muted-foreground">{{ project.description }}</p>
                <p class="text-sm text-muted-foreground">{{ project.startDate | date: 'mediumDate' }} - {{ project.endDate | date: 'mediumDate' }}</p>
              </div>
            </hlm-option>
          }
          <hlm-select-scroll-down />
        </hlm-select-content>
      </hlm-select>
    </div>

    <!-- Amount Field -->
    <div class="space-y-2">
      <label hlmLabel for="amount">Amount *</label>
      <div class="relative">
        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
        <input
          hlmInput
          id="amount"
          type="text"
          [field]="contributionForm.amount"
          placeholder="0.00"
          class="pl-8 w-full"
        />
      </div>
    </div>

    <!-- Description Field -->
    <div class="space-y-2">
      <div class="flex justify-between items-center">
        <label hlmLabel for="description">Description</label>
        <span class="text-sm text-gray-500">
          {{ getDescriptionLength() }}/500
        </span>
      </div>
      <textarea
        hlmInput
        id="description"
        [field]="contributionForm.description"
        placeholder="Add any notes or details about this contribution"
        rows="4"
        class="w-full resize-none"
      ></textarea>
    </div>

    <div class="flex justify-end space-x-3 pt-4 border-t">
      <button
        type="button"
        hlmBtn
        variant="outline"
        class="px-4 py-2"
        (click)="contributionModel.set({ project: null, amount: '', description: '' })"
      >
        Reset Form
      </button>
      <button
        type="submit"
        hlmBtn
        variant="default"
        class="px-4 py-2"
      >
        Add Contribution
      </button>
    </div>
  </form>
</div>
